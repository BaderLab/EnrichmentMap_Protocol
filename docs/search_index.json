[
["index.html", "Pathway enrichment analysis and visualization of omics data using g:Profiler, GSEA, Cytoscape and EnrichmentMap Updated to latest software versions About Attributions:", " Pathway enrichment analysis and visualization of omics data using g:Profiler, GSEA, Cytoscape and EnrichmentMap Updated to latest software versions Ruth Isserlin last modified 2020-12-18 About Original content was published Reimand, J., Isserlin, R., Voisin, V. et al. Pathway enrichment analysis and visualization of omics data using g:Profiler, GSEA, Cytoscape and EnrichmentMap. Nat Protoc 14, 482–517 (2019). https://doi.org/10.1038/s41596-018-0103-9 and this book only updates relevant steps in the protocol procedures section to reflect later versions of software packages. Attributions: This book was created using The bookdown package and can be installed from CRAN or Github: install.packages(&quot;bookdown&quot;) # or the development version # devtools::install_github(&quot;rstudio/bookdown&quot;) Icons are from the “Very Basic. Android L Lollipop” set by Ivan Boyko licensed under CC BY 3.0. "],
["materials.html", "Materials Equipment", " Materials Equipment Hardware A personal computer with Internet access and ≥8 GB of RAM. 1 GB of RAM is sufficient to run GSEA analysis; however, Cytoscape (required to run EnrichmentMap software) requires ≥8 GB of RAM. Software A contemporary web browser (e.g., Chrome) for pathway enrichment analysis with g:Profiler (Step 6A). g:Profiler (https://biit.cs.ut.ee/gprofiler/) Java Standard Edition (http://www.oracle.com/technetwork/java/javase/downloads/index.html) is required to run GSEA and Cytoscape. GSEA desktop application (http://software.broadinstitute.org/gsea/downloads.jsp) is used for pathway enrichment analysis (Step 6B). - currently GSEA 4.1.0 The Cytoscape desktop application (http://www.cytoscape.org/download.php), as well as the following Cytoscape applications (specified the updated versions used for this updated protocol), is required for enrichment map visualization: EnrichmentMap, v.3.3.1 or higher; clusterMaker2, v.1.3.1 or higher; WordCloud, v.3.1.3 or higher; AutoAnnotate, v,1.3.3 or higher. These can be conveniently downloaded and installed together by installing the ‘EnrichmentMap Pipeline Collection’ (http://apps.cytoscape.org/apps/enrichmentmappipelinecollection) from the Cytoscape App Store. Input data We provide downloadable example files that are referred to throughout the protocol (Supplementary Tables 1–13). We recommend saving all these files in a personal project data folder before starting. We also recommend creating an additional result data folder to save the files generated while performing the protocol. Right click on link below and select &quot;Save Link As...&quot;. Place it in the corresponding work directory. A gene list or ranked gene list of interest Example data for Step 6A. g:Profiler requires a list of genes, one per line, in a text file or spreadsheet, ready to copy and paste into a web page: for this, we use genes with frequent somatic SNVs identified in TCGA exome sequencing data of 3,200 tumors of 12 types6. The MuSiC cancer driver mutation detection software was used to find 127 cancer driver genes that displayed higher than expected mutation frequencies in cancer samples (Supplementary Table 1, which is derived from column B of Supplementary Table 4 in ref. 6). Genes are ranked in decreasing order of significance (FDR Q value) and mutation frequency (not shown). Example data for Step 6B. GSEA requires an RNK file with gene scores. An RNK file is a two-column text file with gene IDs in the first column and gene scores in the second column. All (or most) genes in the genome need to have a score, and the gene IDs need to match those used in the GMT file. We provide a ranked list of differentially expressed genes in ovarian cancer from TCGA (Supplementary Table 2). This cohort was previously stratified into four molecular subtypes on the basis of gene expression data, defined as differentiated, immunoreactive, mesenchymal and proliferative7,8. We compared the immunoreactive and mesenchymal subtypes to demonstrate the protocol. Step 5 of Supplementary Protocol 1 shows how this file was created. Pathways gene set database In Step 6A, g:Profiler maintains an up-to-date set of pathway gene sets from multiple sources and no further input from the user is required, but a database of pathway gene sets is required for Step 6B (GSEA). Supplementary Table 3 contains a database of pathway gene sets used for pathway enrichment analysis in the standard GMT format, downloaded from http://baderlab.org/GeneSets. This file contains pathways downloaded on 1 July 2017 from eight data sources: GO(Ashburner et al. 2000), Reactome(Fabregat et al. 2016), Panther(Mi, Muruganujan, and Thomas 2012), NetPath(Kandasamy et al. 2010), NCI(Schaefer et al. 2009), MSigDB curated gene sets (C2 collection, excluding Reactome and KEGG)(Liberzon et al. 2011), MSigDB Hallmark (H collection)(Liberzon et al. 2015) and HumanCyc(Caspi et al. 2016). The gene sets available from http://baderlab.org/GeneSets are updated monthly. A GMT file is a text file in which each line represents a gene set for a single pathway. Each line includes a pathway ID, a name and the list of associated genes in a tab-separated format. - Geneset files used for original protocol References "],
["software-installation.html", "(1-5) Software installation", " (1-5) Software installation Step 1 - Download the required input and output files from the Supplementary Materials of the protocol. Create two directories, project data folder and results data folder. Place all downloaded input and example output files into the project data folder. As you progress through the protocol, place any newly generated files into the results data folder. Step 2 - Install Java v.11 or higher. Follow the download and installation instructions for Java JRE at http://www.oracle.com/technetwork/java/javase/downloads/index.html. Problem: User does not know whether Java is installed on the computer or which version is installed Solution: The Java website (https://www.java.com) has a help page called ‘How to find Java version in Windows or Mac – Manual method’ (https://www.java.com/en/download/help/version_manual.xml) to find which version of Java is already installed Step 3 - Download the latest version of GSEA. We recommend the javaGSEA desktop application available at http://www.broadinstitute.org/gsea/downloads.jsp. Free registration is required. Step 4 - Download the latest version of Cytoscape from http://www.cytoscape.org. Cytoscape v.3.8.2 or higher is required. Step 5 - Install the required Cytoscape applications. Launch Cytoscape. Go to Apps → App Manager (i.e., open the Apps menu and select the item App Manager). In the Install Apps tab search bar, search for EnrichmentMap. Click on EnrichmentMap Pipeline Collection in the center panel. Verify that it is v.1.0.0 or higher. Click on the Install button. Go to the Currently Installed tab and verify that the applications (EnrichmentMap, clusterMaker2, WordCloud and AutoAnnotate) have been installed. "],
["pathway-enrichment-analysis.html", "Pathway enrichment analysis", " Pathway enrichment analysis Step 6 - Two major types of gene lists are used in pathway enrichment analysis of omics data. Flat (unranked) gene lists of dozens to thousands of genes can be analyzed using g:Profiler (option A). A statistical threshold is required to compile a gene list from omics data. By contrast, ranked, whole-genome gene lists are suitable for pathway enrichment analysis using GSEA (option B). Gene lists analyzed with GSEA do not require prior filtering using statistical thresholds. Partial, filtered ranked gene lists can also be analyzed with g:Profiler. Select Step 6A or 6B, depending on the type of gene list you have. Pathway enrichment analysis of a gene list using g:Profiler) Pathway enrichment analysis of a ranked gene list using GSEA "],
["gprofiler-enrich.html", "(6A) Gene list using g:Profiler Specify parameters Downlaod GMT Run Query Filter enrichment results Downlaod Enrichment File", " (6A) Gene list using g:Profiler Specify parameters Open the g:Profiler website at g:Profiler. Paste the gene list (Supplementary_Table1_Cancer_drivers.txt) into the Query field in top-left corner of the screen. Check the box next to Ordered query. This option treats the input as an ordered gene list and prioritizes genes with higher mutation ESs at the beginning of the list. Click on Advanced Options to set additional parameters. The gene list can be space-separated or one per line. The organism for the analysis, Homo sapiens, is selected by default. The input list can contain a mix of gene and protein IDs, symbols and accession numbers. Duplicated and unrecognized IDs will be removed automatically, and ambiguous symbols can be refined in an interactive dialogue after submitting the query. open the file in a simple text editor such as Notepad or Textedit to copy the list of genes. Set Significance threshold to &quot;Benjamini-Hochberg FDR&quot;. if g:Profiler does not return any results: increase the User threshold (0.1, then 1) to check that g:Profiler is running successfully but there are simply no significant results for your query. Alternately, click on All results to return all enrichments irrespective of significance. Click on the Data sources tab (black rectangle) to expand it. UnSelect the following gene-set databases by clicking the &quot;clear all&quot; button. In the Gene Ontology category, check GO Biological Process and No electronic GO annotations. In the biological pathways category, check Reactome. No electronic GO annotations option will discard less reliable GO annotations (IEAs) that are not manually reviewed. if g:Profiler does not return any results uncheck the No electronic GO annotation option to expand annotations used in the test. Downlaod GMT Optional but recommended: Download the required GMT pathway database file. Click on the 'combined name.gmt' link located at bottom of the dataset tab. It will download a file named combined name.gmt containing a pathway database GMT file with all the available sources. (Optional) concatenate the GO:BP and Reactome gmt files: If you want to create a smaller gmt file that doesn't contain all of the gprofiler datasources you can instead download name.gmt.zip that contains each datasource as its own GMT file. You will need to concatenate the sources you require into one GMT file to use for later. Option 1: Merge manually, if you are not familiar with unix commands open a text editor such a Notepad or equivalent open hsapiens.GO:BP.name.gmt using the text editor open gmt hsapiens.REAC.name.gmt using the text editor copy-paste all the rows from REAC file together with all the rows in GO:BP file and save it as hsapiens.pathways.name.gmt . Option 2: using the cat command if you are familiar with unix commands open your terminal window cd to the unzipped gprofiler_hsapiens.name folder type the following command: cat hsapiens.GO:BP.name.gmt hsapiens.REAC.name.gmt &gt; hsapiens.pathways.name.gmt you will be using this optional hsapiens.pathways.name.gmt file in Cytoscape EnrichmentMap. Run Query Click Run Query to run the analysis. The Run Query button will change to Run Query ... while it is running and Run Query ✓ when the query is complete. The ✓ will only remain there momentarily and then return to Run Query button. If you miss the button changing from &quot;...&quot; to ✓ it might appear that nothing has happened. Scroll down to see results. A graphical map of the resulting pathways will be shown, with the -log10(pvalue) along the y axis and the associated pathways of the input list shown along the x axis divided by datasource. By default, results with Q values &lt;0.05 are reported but all pathways are shown in the graphical map with a dotted line indicating which pathways are significant and pass correction. Mousing over any of the dots will display the source identifier, pathway name and associated p-value. Filter enrichment results Click Detailed Results tab to see detailed results. A graphical heat map image will be shown, with detected pathways shown along the y axis (left) and associated genes of the input list shown along the x axis (top). Resulting pathways are listed by p-value. g:Profiler returns only statistically significant pathways with P values adjusted for multiple testing correction (called Q values). By default, results with Q values &lt;0.05 are reported. g:Profiler reports unrecognized and ambiguous gene IDs that can be resolved manually. For GO pathways and gene sets the boxes under each gene will be filled with different colours. The different colours represent different evidence codes. To see the legend specifying what each colour represents click on legend drop down above heatmap. Set the Term Size slider to minimum 3 and maximum 350. The analysis will consider only more reliable pathways that have three or more genes and no more than 350. To see the specific numbers used to calculate the statistics for each gene set click on the &quot;&gt;&gt;&quot; in the header of the heatmap. This will add T (number of genes associated with the term), Q (number of genes in the query) , T intersect Q (the number of genes found in both the term and the query), U (the number of genes in the universe). If ordered query is selected then the number of query genes associated with each pathway will fluctuate as g:Profiler sequenctially increases the number of genes tested and finds the set of genes that generate the most significant result. Downlaod Enrichment File Click on the option GEM (Generic Enrichment Map). This file is required for visualizing pathway results with Cytoscape and EnrichmentMap. "],
["gsea-enrich.html", "(6B) Ranked gene list using GSEA Loading the required data files into GSEA Specifying parameters Running GSEA Examining GSEA results", " (6B) Ranked gene list using GSEA Loading the required data files into GSEA Launch GSEA by double clicking on the installed Application. Unable to launch GSEA When launching GSEA on macOS for the first time, you may get the error ‘gsea.jnlp cannot be opened because it is from an unidentified developer’. Follow instructions specified on download page: If you see this error message: Open Settings -&gt; Security &amp; Privacy Click on &quot;Open Anyways&quot; If GSEA still fails to launch, GSEA can alternatively be launched from the command line. Go to the GSEA download site (http://www.broadinstitute.org/gsea/downloads.jsp) and download the javaGSEA JAR file (the second option on the download site). Open a command-line terminal. On macOS, the terminal can be found in Applications → Utilities → Terminal. On Windows, type cmd in the Windows program files search bar. Then navigate to the directory where the file javaGSEA.jar was downloaded, using the command cd. For example, on macOS run cd ~/Downloads if you downloaded the GSEA.jar file to your Downloads folder. Run the command java –Xmx4G –jar gsea-3.0.jar, where –Xmx specifies how much memory is given to GSEA. Click on Load Data in the top left corner of the Steps in GSEA Analysis section. In the Load Data tab, click on Browse for files … Load your ranked genes and GMT file Find your project data folder and select the Supplementary_Table2_MesenvsImmuno_RNASeq_ranks.rnk file. Also select the pathway gene set definition (GMT), Supplementary_Table3_Human_GOBP_AllPathways_no_GO_iea_July_01_2017_symbol.gmt file using a multiple-select method such as shift-click. Click the Choose button to continue. A message box indicates that the files were loaded successfully. Click the OK button to continue. GSEA seems non-responsive It may take 5–10 s for GSEA to load input files. The files are loaded successfully once a message appears on the screen, e.g., ‘Files loaded successfully: 2/2. There were no errors’ Alternatively, you can choose Method 3 to drag and drop files here; you need to click on the Load these files! button in this case. Creating your own files for GSEA GSEA has a useful help documentation on file formats available at https://software.broadinstitute.org/cancer/software/gsea/wiki/index.php/Data_formats Specifying parameters Click on Run GSEAPreranked in the side bar under Tools. The Run GSEA on a Pre-Ranked gene list tab will appear. Gene sets database. Click on the button ‘(…)’ located to the right and wait a few seconds for the gene set selection window to appear. Go to the Gene matrix (local gmx/gmt) tab by using the top right arrow. Click on the downloaded local GMT file, ‘Supplementary_Table3_Human_GOBP_AllPathways_no_GO_iea_July_01_2017_symbol.gmt’. click on OK at the bottom of the window. GMT files GSEA also supplies its own gene set files, which are accessible directly through the GSEA interface from the MSigDB resource(Liberzon et al. 2011, Liberzon et al. (2015)). These files do not need to be imported into GSEA. To define the GMT file, find the MSigDB gene set files in the first tab, Gene Matrix (from website), of the Select one or more genesets dialog. The latest versions of the MSigDB gene set files are shown in bold, but the earlier versions can also be accessed. To select multiple gene set files, click on the desired files while holding the control key in Windows or the command key in macOS. Number of permutations. This specifies the number of times that the gene sets will be randomized to create the null distribution to calculate the P value and FDR Q value. Use the default value of 1,000 permutations. Higher numbers of permutations require longer computation times. To calculate the FDR Q value for each gene set, the dataset is randomized by permuting the genes in each gene set and recalculating the P values for the randomized set. This parameter specifies how many times this randomization is done. The more randomizations are performed, the more precise the FDR Q value estimation will be (to a limit, as eventually the FDR Q value will stabilize at the actual value). On a Windows machine with 16 G of RAM and an i7 3.4-GHz processor, an analysis with 10, 100, 500 or 1,000 randomizations on our example set with the above defined parameters takes 155, 224, 544, and 1,012 s, respectively. Ranked List - Select the ranked gene list by clicking on the right-most arrows and highlighting the rank file Supplementary_Table2_MesenvsImmuno_RNASeq_ranks.rnk. Collapse/Remap to gene symbols - Change to No_collapse. (Our rank file already contains the gene symbols so we don't need GSEA to try and convert probe names to gene symbols) Click the Show button next to Basic fields to display additional options. Analysis name. Change the default ‘my_analysis’ to a specific name, for example, ‘Mesen_vs_Immuno’. Max size: exclude larger sets. By default, GSEA sets the upper limit to 500. Set this to 200 to remove the larger sets from the analysis. Save results in this folder. Navigate to the folder where GSEA should save the results. We recommend you choose the result data folder created in Step 1. Otherwise, GSEA will use the default location ‘gsea_home/output/[date]’ in your home directory. set Enrichment Statistics to p2 if you want to add more weight on the most top up-regulated and top down-regulated. P2 is a more stringent parameter and it will result in less gene-sets significant under FDR &lt;0.05. Running GSEA Run GSEA by clicking on the Run button located at the bottom of the window. Expand the window if the button is not visible. The GSEA reports pane at the bottom left of the window will show the status ‘Running’. It will be updated to ‘Success’ upon completion. This is expected to be a long-running process, depending on the speed of your computer. GSEA looks non-responsive, but it is actually computing enrichments GSEA has no progress bar to indicate estimated time to completion. A run can take a few minutes or hours, depending on the size of the data and the computer speed. Click on the ‘+’ in the bottom left corner of the screen to see messages such as ‘shuffleGeneSet for GeneSet 76/4714 nperm: 1000’ . This message indicates that GSEA is shuffling 4,714 gene sets 1,000 times each, 76 of which are complete. Once the permutations are complete, GSEA generates the report Error message 'Java Heap space' The error message ‘Java Heap space’ indicates that the software has run out of memory. Another version of GSEA is needed if you are running the GSEA desktop application. There are multiple options available for download from the GSEA website. You can download a webstart application that launches GSEA with 1, 2, 4 or 8 GB of RAM. Upgrade to a webstart that launches with more memory. If you are already using the webstart that launches with 8 GB, then you require a GSEA JAVA .jar file, which can be executed from the command line with increased memory (see Troubleshooting for Step 6B(i) for details) Examining GSEA results Once the GSEA analysis is complete, a green notification ‘Success’ will appear in the bottom left section of the screen. All GSEA output files will be automatically saved and be available in the folder you specified in the GseaPreranked interface (Step 6B(xiii)). Click on Success to open the results in your web browser. Pathways enriched in top-ranking genes (i.e., upregulated) are shown in the first set (‘na_pos’; ‘mesenchymal’ in this protocol) and pathways enriched in bottom-ranked genes (i.e., downregulated) are shown in the second set (‘na_neg’; ‘immunoreactive’) User needs to access previous results but cannot find them If the GSEA software is closed, you can access previous results by: opening the working folder and opening the ‘index.html’ file. Alternatively, you can re-launch GSEA and click on: Analysis history, then History and then navigate to date of your analysis. Although all analyses, regardless of where the results files were saved, are listed under history, they are organized by the date the analyses were run. If you cannot remember when you ran a specific analysis, then you may have to manually search through a few directories to find the desired analysis A. Web page summary of GSEA results showing pathways enriched in the top or bottom of the ranked list, with the ‘na_pos’ and ‘na_neg’ phenotypes corresponding to enrichment in upregulated and downregulated genes, respectively. These have been manually labeled here as mesenchymal and immunoreactive, respectively. A. An example enrichment plot for the top pathway in the mesenchymal set. A. An example enrichment plot for the top pathway in the immunoreactive set. In the web browser results summary, click on the Snapshot link under the results to get an overview of the top 20 findings. The most significant pathways for the first phenotype (‘na_pos’) should clearly display enrichment in top-ranking (i.e., upregulated) genes (left side of the plot). Conversely, the most significant pathways for the second phenotype (‘na_neg’) should clearly display enrichment in bottom-ranked (i.e., downregulated) genes (right side of the plot) When running GSEA with expression data as input (instead of a pre-calculated rank file), a phenotype label (i.e., biological condition or sample class) is provided as input for each sample and specified in the GSEA ‘cls’ file. When running GSEA, the two phenotypes to compare for differential gene expression analysis are specified and these phenotypes are used in the pathway enrichment result files. By contrast, in a GSEA preranked analysis (i.e., when a ranked gene list is provided by the user), GSEA automatically labels one phenotype ‘na_pos’ (corresponding to enrichment in the genes at the top of the ranked list, where ‘na’ means the phenotype label is ‘not available’) and the other ‘na_neg’ (corresponding to enrichment in the genes at the bottom of the ranked list). This convention is also used by the EnrichmentMap software, designating the first phenotype as ‘positive’ and the second phenotype as ‘negative’. Class/phenotype-specific GSEA output in the web page summary shows how many gene sets were found enriched in upregulated genes, regardless of significance (purple), the total number of gene sets used after size filtering (cyan), the phenotype name (red) and the number of gene sets that pass different thresholds (orange). In the web browser results summary, click on Detailed enrichment results in HTML format and use the row numbering to check the number of pathways that have FDR Q values &lt;0.05 to determine appropriate thresholds for EnrichmentMap in the next step of the protocol. If no pathways are reported at Q &lt; 0.05, more lenient thresholds such as Q &lt; 0.1 or Q &lt; 0.25 could be used. The threshold Q &lt; 0.25 provides very lenient filtering, and it is not uncommon to find thousands of enriched pathways at this level. Robust analyses should use a cutoff of Q &lt; 0.05 or lower. Filtering only by uncorrected P values is inappropriate and not recommended. Few or no results returned by GSEA Check the number of gene sets that were analyzed. If the number is low (e.g., low hundreds), it could indicate gene ID mapping problems References "],
["visualization-of-enrichment-results-with-enrichmentmap.html", "(7-9) Visualization of enrichment results with EnrichmentMap", " (7-9) Visualization of enrichment results with EnrichmentMap Step 7 - Launch the Cytoscape software. Introductory Cytoscape tutorials can be found at http://tutorials.cytoscape.org. Step 8 - In the menu, click Apps → EnrichmentMap. Step 9 - The Create Enrichment Map panel will appear. Creation of enrichment maps with g:Profiler (option A) and GSEA (option B) requires different input files. Other than the specific input files, the parameters are the same for the two analysis types. Attributes surrounded by a dashed box should be filled out automatically if the user selects an appropriate folder with the required files. Missing file names indicate that EnrichmentMap was unable to find the specified file. Orange boxes indicate optional files. For the examples presented in the protocol, optional files are used for the GSEA analysis but not for the g:Profiler analysis to demonstrate the two distinct use cases. EM, EnrichmentMap. g:Profiler - Creation of enrichment maps for results generated in Step 6A GSEA - Creation of enrichment maps for results generated in Step 6B "],
["gprofiler-em.html", "(9A) g:Profiler - Creation of enrichment maps for results generated in Step 6A Parameter specification Specification of additional optional files: Tuning parameters", " (9A) g:Profiler - Creation of enrichment maps for results generated in Step 6A Step 9A - Parameter specification In the Create Enrichment Map panel, click on folder icon. Locate and select your result data folder containing the g:Profiler results and click on Open. Autoload of g:Profiler results creates many datasets with incorrect file specifications There are too many text files within the directory specified. To simplify loading g:Profiler results into EnrichmentMap and populating the correct fields in the EnrichmentMap interface, place the g:Profiler results file and gene set file (i.e., Supplementary_Table4_gprofiler_results.txt and Supplementary_Table5_hsapiens.pathways.NAME.gmt) into a directory together by themselves. See Example here In the right-hand pane, g:Profiler output files will be automatically populated into their specified fields. Alternatively, users can click on the ‘+’ symbol to specify each of the required files manually. In the right-hand pane, modify the Name of the created dataset if desired. By default, EnrichmentMap will use the name of the g:Profiler enrichment results file (e.g., ‘Supplementary_Table4_gprofiler_results.txt’). Verify that the Analysis Type is set to Generic/gProfiler/Enrichr. Verify the Enrichments results file is the g:Profiler file downloaded in Step 6A(xi) (or alternatively, manually specify ‘Supplementary_Table4_gprofiler_results.txt’). Verify the GMT specified is the file retrieved from the g:Profiler website in Step 6A(xii). Use the file ‘hsapiens.pathways.NAME.gmt’ (or alternatively manually specify ‘Supplementary_Table5_hsapiens.pathways.NAME.gmt’) that contains the gene sets corresponding to GO biological processes and Reactome pathways. Specification of additional optional files: Expressions. (Optional) Upload an expression matrix for the genes analyzed in g:Profiler or, alternatively, upload an expression dataset of all genes. If the expression dataset contains additional genes not used for the g:Profiler search, their expression values will still appear in the heat map of the enrichment map (for an example file, see Supplementary Table 6). Ranks. (Optional) Ranks for the gene list or the expression data can be specified (for an example, see Supplementary Table 2). Classes. (Optional) This is a GSEA CLS file defining the phenotype (i.e., biological conditions) of each sample in the expression file; for an example, see Supplementary Table 7. This file is required only for phenotype randomization in GSEA; however, providing it to EnrichmentMap will label the columns of the expression file in the EnrichmentMap heat map viewer by phenotype. Phenotypes. (Optional) If there are two different phenotypes in the expression data, update the phenotype labels so that ‘positive’ represents the phenotype associated with positive values (mesenchymal in this example) and ‘negative’ represents that associated with negative values (immunoreactive in this example). Using phenotypes with g:Profiler analyses Although an individual g:Profiler analysis has only one phenotype, it is possible to modify a single results file to contain two analyses. This is relevant when the phenotypes are mutually exclusive. For the analysis you want to associate with the additional phenotype (which would correspond to downregulated genes in GSEA PreRanked, thus called ‘negative’) open the g:Profiler results file (preferably in a spreadsheet, so you can easily modify a single column). The fifth column specifies the phenotype. Update the column to have the value of ‘−1’ for each result in the file. Open the second analysis file. Copy all the results from the second file and paste them into the updated negative g:Profiler file. Save the file and use it as the g:Profiler enrichment results file in the EnrichmentMap interface instead of the original results files. Pathways corresponding to two phenotypes will be colored red and blue in the resulting enrichment map. One limitation with this approach is that a pathway cannot be included in both the positive and the negative sets. Tuning parameters Number of Nodes. By default, g:Profiler returns only statistically significant results (Q &lt; 0.05), so the FDR q-value cutoff parameter can be set to 1 in the EnrichmentMap Input panel, unless a more stringent filtering is desired. For this protocol, set the FDR Q value to 0.001. (Optional) Select Filter genes by expressions to exclude any genes in the gene set definition file (i.e., the GMT file) that are not found in the supplied expression file. If Filter genes by expressions is not selected, any gene that is not found in the expression file will be retained and will be presented in the expression heat map viewer with all of its associated expression values grayed out. Number of Edges. Keep the connectivity slider in the center. If the network is too cluttered because of too many connections (edges), move the slider to the left to make the network sparser. Alternatively, if the network is too sparse (i.e., there are too many disconnected pathways), move the slider to the right to obtain a more densely connected network. Moving the slider to the left (or right) will adjust the underlying similarity statistic threshold to make the resulting network sparser (or denser). The slider is set with predefined defaults, but users can fine-tune the similarity metric by selecting Show advanced options at the bottom of the Create Enrichment Map panel. Predefined values appear as tick marks on the slider and include: Jaccard &gt; 0.35, Jaccard &gt; 0.25, combined &gt; 0.375, overlap &gt; 0.5, and overlap &gt; 0.25. Click the Build button at the bottom of the EnrichmentMap Input panel. A Building EnrichmentMap box appears and indicates the progress status. This box will disappear once the map has been created successfully. the resulting enrichment maps from the g:Profiler analysis. "],
["references.html", "References", " References "]
]
