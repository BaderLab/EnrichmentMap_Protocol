[
["index.html", "Pathway enrichment analysis and visualization of omics data using g:Profiler, GSEA, Cytoscape and EnrichmentMap Updated to latest software versions About Attributions:", " Pathway enrichment analysis and visualization of omics data using g:Profiler, GSEA, Cytoscape and EnrichmentMap Updated to latest software versions Ruth Isserlin last modified 2021-01-18 About Original content was published Reimand, J., Isserlin, R., Voisin, V. et al. Pathway enrichment analysis and visualization of omics data using g:Profiler, GSEA, Cytoscape and EnrichmentMap. Nat Protoc 14, 482–517 (2019). https://doi.org/10.1038/s41596-018-0103-9 and this book only updates relevant steps in the protocol procedures section to reflect later versions of software packages. Attributions: This book was created using The bookdown package and can be installed from CRAN or Github: install.packages(&quot;bookdown&quot;) # or the development version # devtools::install_github(&quot;rstudio/bookdown&quot;) Icons are from the “Very Basic. Android L Lollipop” set by Ivan Boyko licensed under CC BY 3.0. "],
["materials.html", "Materials Equipment", " Materials Equipment Hardware A personal computer with Internet access and ≥8 GB of RAM. 1 GB of RAM is sufficient to run GSEA analysis; however, Cytoscape (required to run EnrichmentMap software) requires ≥8 GB of RAM. Software A contemporary web browser (e.g., Chrome) for pathway enrichment analysis with g:Profiler (Step 6A). g:Profiler (https://biit.cs.ut.ee/gprofiler/)(Raudvere et al. 2019) Java Standard Edition (http://www.oracle.com/technetwork/java/javase/downloads/index.html) is required to run GSEA and Cytoscape. GSEA desktop application(Subramanian et al. 2005) (http://software.broadinstitute.org/gsea/downloads.jsp) is used for pathway enrichment analysis (Step 6B). - currently GSEA 4.1.0 The Cytoscape desktop application (http://www.cytoscape.org/download.php), as well as the following Cytoscape applications (specified the updated versions used for this updated protocol), is required for enrichment map visualization: EnrichmentMap, v.3.3.1 or higher; clusterMaker2, v.1.3.1 or higher; WordCloud, v.3.1.3 or higher; AutoAnnotate, v,1.3.3 or higher. These can be conveniently downloaded and installed together by installing the ‘EnrichmentMap Pipeline Collection’ (http://apps.cytoscape.org/apps/enrichmentmappipelinecollection) from the Cytoscape App Store. Input data We provide downloadable example files that are referred to throughout the protocol (Supplementary Tables 1–13). We recommend saving all these files in a personal project data folder before starting. We also recommend creating an additional result data folder to save the files generated while performing the protocol. Right click on link below and select &quot;Save Link As...&quot;. Place it in the corresponding work directory. A gene list or ranked gene list of interest Example data for Step 6A. g:Profiler requires a list of genes, one per line, in a text file or spreadsheet, ready to copy and paste into a web page: for this, we use genes with frequent somatic SNVs identified in TCGA exome sequencing data of 3,200 tumors of 12 types(Kandoth et al. 2013). The MuSiC cancer driver mutation detection software was used to find 127 cancer driver genes that displayed higher than expected mutation frequencies in cancer samples (Supplementary Table 1, which is derived from column B of Supplementary Table 4 in (Kandoth et al. 2013)). Genes are ranked in decreasing order of significance (FDR Q value) and mutation frequency (not shown). Example data for Step 6B. GSEA requires an RNK file with gene scores. An RNK file is a two-column text file with gene IDs in the first column and gene scores in the second column. All (or most) genes in the genome need to have a score, and the gene IDs need to match those used in the GMT file. We provide a ranked list of differentially expressed genes in ovarian cancer from TCGA (Supplementary Table 2). This cohort was previously stratified into four molecular subtypes on the basis of gene expression data, defined as differentiated, immunoreactive, mesenchymal and proliferative(Verhaak et al. 2012,Network and others (2011)). We compared the immunoreactive and mesenchymal subtypes to demonstrate the protocol. Step 5 of Supplementary Protocol 1 shows how this file was created. Pathways gene set database In Step 6A, g:Profiler maintains an up-to-date set of pathway gene sets from multiple sources and no further input from the user is required, but a database of pathway gene sets is required for Step 6B (GSEA). Supplementary Table 3 contains a database of pathway gene sets used for pathway enrichment analysis in the standard GMT format, downloaded from http://baderlab.org/GeneSets. This file contains pathways downloaded on 1 July 2017 from eight data sources: GO(Ashburner et al. 2000), Reactome(Fabregat et al. 2016), Panther(Mi, Muruganujan, and Thomas 2012), NetPath(Kandasamy et al. 2010), NCI(Schaefer et al. 2009), MSigDB curated gene sets (C2 collection, excluding Reactome and KEGG)(Liberzon et al. 2011), MSigDB Hallmark (H collection)(Liberzon et al. 2015) and HumanCyc(Caspi et al. 2016). The gene sets available from http://baderlab.org/GeneSets are updated monthly. A GMT file is a text file in which each line represents a gene set for a single pathway. Each line includes a pathway ID, a name and the list of associated genes in a tab-separated format. - Geneset files used for original protocol References "],
["software-installation.html", "(1-5) Software installation", " (1-5) Software installation Step 1 - Download the required input and output files from the Supplementary Materials of the protocol. Create two directories, project data folder and results data folder. Place all downloaded input and example output files into the project data folder. As you progress through the protocol, place any newly generated files into the results data folder. Step 2 - Install Java v.11 or higher. Follow the download and installation instructions for Java JRE at http://www.oracle.com/technetwork/java/javase/downloads/index.html. Problem: User does not know whether Java is installed on the computer or which version is installed Solution: The Java website (https://www.java.com) has a help page called ‘How to find Java version in Windows or Mac – Manual method’ (https://www.java.com/en/download/help/version_manual.xml) to find which version of Java is already installed Step 3 - Download the latest version of GSEA. We recommend the javaGSEA desktop application available at http://www.broadinstitute.org/gsea/downloads.jsp. Free registration is required. Step 4 - Download the latest version of Cytoscape from http://www.cytoscape.org. Cytoscape v.3.8.2 or higher is required. Step 5 - Install the required Cytoscape applications. Launch Cytoscape. Go to Apps → App Manager (i.e., open the Apps menu and select the item App Manager). In the Install Apps tab search bar, search for EnrichmentMap. Click on EnrichmentMap Pipeline Collection in the center panel. Verify that it is v.1.0.0 or higher. Click on the Install button. Go to the Currently Installed tab and verify that the applications (EnrichmentMap, clusterMaker2, WordCloud and AutoAnnotate) have been installed. "],
["pathway-enrichment-analysis.html", "Pathway enrichment analysis", " Pathway enrichment analysis Step 6 - Two major types of gene lists are used in pathway enrichment analysis of omics data. Flat (unranked) gene lists of dozens to thousands of genes can be analyzed using g:Profiler (option A). A statistical threshold is required to compile a gene list from omics data. By contrast, ranked, whole-genome gene lists are suitable for pathway enrichment analysis using GSEA (option B). Gene lists analyzed with GSEA do not require prior filtering using statistical thresholds. Partial, filtered ranked gene lists can also be analyzed with g:Profiler. Select Step 6A or 6B, depending on the type of gene list you have. Pathway enrichment analysis of a gene list using g:Profiler) Pathway enrichment analysis of a ranked gene list using GSEA "],
["gprofiler-enrich.html", "(6A) Gene list using g:Profiler Specify parameters Downlaod GMT Run Query Filter enrichment results Downlaod Enrichment File", " (6A) Gene list using g:Profiler Specify parameters Open the g:Profiler website at g:Profiler. Paste the gene list (Supplementary_Table1_Cancer_drivers.txt) into the Query field in top-left corner of the screen. Check the box next to Ordered query. This option treats the input as an ordered gene list and prioritizes genes with higher mutation ESs at the beginning of the list. Click on Advanced Options to set additional parameters. The gene list can be space-separated or one per line. The organism for the analysis, Homo sapiens, is selected by default. The input list can contain a mix of gene and protein IDs, symbols and accession numbers. Duplicated and unrecognized IDs will be removed automatically, and ambiguous symbols can be refined in an interactive dialogue after submitting the query. open the file in a simple text editor such as Notepad or Textedit to copy the list of genes. Set Significance threshold to &quot;Benjamini-Hochberg FDR&quot;. if g:Profiler does not return any results: increase the User threshold (0.1, then 1) to check that g:Profiler is running successfully but there are simply no significant results for your query. Alternately, click on All results to return all enrichments irrespective of significance. Click on the Data sources tab (black rectangle) to expand it. UnSelect the following gene-set databases by clicking the &quot;clear all&quot; button. In the Gene Ontology category, check GO Biological Process and No electronic GO annotations. In the biological pathways category, check Reactome. No electronic GO annotations option will discard less reliable GO annotations (IEAs) that are not manually reviewed. if g:Profiler does not return any results uncheck the No electronic GO annotation option to expand annotations used in the test. Downlaod GMT Optional but recommended: Download the required GMT pathway database file. Click on the 'combined name.gmt' link located at bottom of the dataset tab. It will download a file named combined name.gmt containing a pathway database GMT file with all the available sources. (Optional) concatenate the GO:BP and Reactome gmt files: If you want to create a smaller gmt file that doesn't contain all of the gprofiler data sources you can instead download name.gmt.zip that contains each data source as its own GMT file. You will need to concatenate the sources you require into one GMT file to use for later. Option 1: Merge manually, if you are not familiar with unix commands open a text editor such a Notepad or equivalent open hsapiens.GO:BP.name.gmt using the text editor open gmt hsapiens.REAC.name.gmt using the text editor copy-paste all the rows from REAC file together with all the rows in GO:BP file and save it as hsapiens.pathways.name.gmt . Option 2: using the cat command if you are familiar with unix commands open your terminal window cd to the unzipped gprofiler_hsapiens.name folder type the following command: cat hsapiens.GO:BP.name.gmt hsapiens.REAC.name.gmt &gt; hsapiens.pathways.name.gmt you will be using this optional hsapiens.pathways.name.gmt file in Cytoscape EnrichmentMap. Run Query Click Run Query to run the analysis. The Run Query button will change to Run Query ... while it is running and Run Query ✓ when the query is complete. The ✓ will only remain there momentarily and then return to Run Query button. If you miss the button changing from &quot;...&quot; to ✓ it might appear that nothing has happened. Scroll down to see results. A graphical map of the resulting pathways will be shown, with the -log10(pvalue) along the y axis and the associated pathways of the input list shown along the x axis divided by data source. By default, results with Q values &lt;0.05 are reported but all pathways are shown in the graphical map with a dotted line indicating which pathways are significant and pass correction. Mousing over any of the dots will display the source identifier, pathway name and associated p-value. Filter enrichment results Click Detailed Results tab to see detailed results. A graphical heat map image will be shown, with detected pathways shown along the y axis (left) and associated genes of the input list shown along the x axis (top). Resulting pathways are listed by p-value. g:Profiler returns only statistically significant pathways with P values adjusted for multiple testing correction (called Q values). By default, results with Q values &lt;0.05 are reported. g:Profiler reports unrecognized and ambiguous gene IDs that can be resolved manually. For GO pathways and gene sets the boxes under each gene will be filled with different colours. The different colours represent different evidence codes. To see the legend specifying what each colour represents click on legend drop down above heatmap. Set the Term Size slider to minimum 3 and maximum 350. The analysis will consider only more reliable pathways that have three or more genes and no more than 350. To see the specific numbers used to calculate the statistics for each gene set click on the &quot;&gt;&gt;&quot; in the header of the heatmap. This will add T (number of genes associated with the term), Q (number of genes in the query) , T intersect Q (the number of genes found in both the term and the query), U (the number of genes in the universe). If ordered query is selected then the number of query genes associated with each pathway will fluctuate as g:Profiler sequentially increases the number of genes tested and finds the set of genes that generate the most significant result. Downlaod Enrichment File Click on the option GEM (Generic Enrichment Map). This file is required for visualizing pathway results with Cytoscape and EnrichmentMap. "],
["gsea-enrich.html", "(6B) Ranked gene list using GSEA Loading the required data files into GSEA Specifying parameters Running GSEA Examining GSEA results", " (6B) Ranked gene list using GSEA Loading the required data files into GSEA Launch GSEA by double clicking on the installed Application. Unable to launch GSEA When launching GSEA on macOS for the first time, you may get the error ‘gsea.jnlp cannot be opened because it is from an unidentified developer’. Follow instructions specified on download page: If you see this error message: Open Settings -&gt; Security &amp; Privacy Click on &quot;Open Anyways&quot; If GSEA still fails to launch, GSEA can alternatively be launched from the command line. Go to the GSEA download site (http://www.broadinstitute.org/gsea/downloads.jsp) and download the javaGSEA JAR file (the second option on the download site). Open a command-line terminal. On macOS, the terminal can be found in Applications → Utilities → Terminal. On Windows, type cmd in the Windows program files search bar. Then navigate to the directory where the file javaGSEA.jar was downloaded, using the command cd. For example, on macOS run cd ~/Downloads if you downloaded the GSEA.jar file to your Downloads folder. Run the command java –Xmx4G –jar gsea-3.0.jar, where –Xmx specifies how much memory is given to GSEA. Click on Load Data in the top left corner of the Steps in GSEA Analysis section. In the Load Data tab, click on Browse for files … Load your ranked genes and GMT file Find your project data folder and select the Supplementary_Table2_MesenvsImmuno_RNASeq_ranks.rnk file. Also select the pathway gene set definition (GMT), Supplementary_Table3_Human_GOBP_AllPathways_no_GO_iea_July_01_2017_symbol.gmt file using a multiple-select method such as shift-click. Click the Choose button to continue. A message box indicates that the files were loaded successfully. Click the OK button to continue. GSEA seems non-responsive It may take 5–10 s for GSEA to load input files. The files are loaded successfully once a message appears on the screen, e.g., ‘Files loaded successfully: 2/2. There were no errors’ Alternatively, you can choose Method 3 to drag and drop files here; you need to click on the Load these files! button in this case. Creating your own files for GSEA GSEA has a useful help documentation on file formats available at https://software.broadinstitute.org/cancer/software/gsea/wiki/index.php/Data_formats Specifying parameters Click on Run GSEAPreranked in the side bar under Tools. The Run GSEA on a Pre-Ranked gene list tab will appear. Gene sets database. Click on the button ‘(…)’ located to the right and wait a few seconds for the gene set selection window to appear. Go to the Gene matrix (local gmx/gmt) tab by using the top right arrow. Click on the downloaded local GMT file, ‘Supplementary_Table3_Human_GOBP_AllPathways_no_GO_iea_July_01_2017_symbol.gmt’. click on OK at the bottom of the window. GMT files GSEA also supplies its own gene set files, which are accessible directly through the GSEA interface from the MSigDB resource(Liberzon et al. 2011, Liberzon et al. (2015)). These files do not need to be imported into GSEA. To define the GMT file, find the MSigDB gene set files in the first tab, Gene Matrix (from website), of the Select one or more genesets dialog. The latest versions of the MSigDB gene set files are shown in bold, but the earlier versions can also be accessed. To select multiple gene set files, click on the desired files while holding the control key in Windows or the command key in macOS. Number of permutations. This specifies the number of times that the gene sets will be randomized to create the null distribution to calculate the P value and FDR Q value. Use the default value of 1,000 permutations. Higher numbers of permutations require longer computation times. To calculate the FDR Q value for each gene set, the dataset is randomized by permuting the genes in each gene set and recalculating the P values for the randomized set. This parameter specifies how many times this randomization is done. The more randomizations are performed, the more precise the FDR Q value estimation will be (to a limit, as eventually the FDR Q value will stabilize at the actual value). On a Windows machine with 16 G of RAM and an i7 3.4-GHz processor, an analysis with 10, 100, 500 or 1,000 randomizations on our example set with the above defined parameters takes 155, 224, 544, and 1,012 s, respectively. Ranked List - Select the ranked gene list by clicking on the right-most arrows and highlighting the rank file Supplementary_Table2_MesenvsImmuno_RNASeq_ranks.rnk. Collapse/Remap to gene symbols - Change to No_collapse. (Our rank file already contains the gene symbols so we don't need GSEA to try and convert probe names to gene symbols) Click the Show button next to Basic fields to display additional options. Analysis name. Change the default ‘my_analysis’ to a specific name, for example, ‘Mesen_vs_Immuno’. Max size: exclude larger sets. By default, GSEA sets the upper limit to 500. Set this to 200 to remove the larger sets from the analysis. Save results in this folder. Navigate to the folder where GSEA should save the results. We recommend you choose the result data folder created in Step 1. Otherwise, GSEA will use the default location ‘gsea_home/output/[date]’ in your home directory. set Enrichment Statistics to p2 if you want to add more weight on the most top up-regulated and top down-regulated. P2 is a more stringent parameter and it will result in less gene-sets significant under FDR &lt;0.05. Running GSEA Run GSEA by clicking on the Run button located at the bottom of the window. Expand the window if the button is not visible. The GSEA reports pane at the bottom left of the window will show the status ‘Running’. It will be updated to ‘Success’ upon completion. This is expected to be a long-running process, depending on the speed of your computer. GSEA looks non-responsive, but it is actually computing enrichments GSEA has no progress bar to indicate estimated time to completion. A run can take a few minutes or hours, depending on the size of the data and the computer speed. Click on the ‘+’ in the bottom left corner of the screen to see messages such as ‘shuffleGeneSet for GeneSet 76/4714 nperm: 1000’ . This message indicates that GSEA is shuffling 4,714 gene sets 1,000 times each, 76 of which are complete. Once the permutations are complete, GSEA generates the report Error message 'Java Heap space' The error message ‘Java Heap space’ indicates that the software has run out of memory. Another version of GSEA is needed if you are running the GSEA desktop application. There are multiple options available for download from the GSEA website. You can download a webstart application that launches GSEA with 1, 2, 4 or 8 GB of RAM. Upgrade to a webstart that launches with more memory. If you are already using the webstart that launches with 8 GB, then you require a GSEA JAVA .jar file, which can be executed from the command line with increased memory (see Troubleshooting for Step 6B(i) for details) Examining GSEA results Once the GSEA analysis is complete, a green notification ‘Success’ will appear in the bottom left section of the screen. All GSEA output files will be automatically saved and be available in the folder you specified in the GseaPreranked interface (Step 6B(xiii)). Click on Success to open the results in your web browser. Pathways enriched in top-ranking genes (i.e., upregulated) are shown in the first set (‘na_pos’; ‘mesenchymal’ in this protocol) and pathways enriched in bottom-ranked genes (i.e., downregulated) are shown in the second set (‘na_neg’; ‘immunoreactive’) User needs to access previous results but cannot find them If the GSEA software is closed, you can access previous results by: opening the working folder and opening the ‘index.html’ file. Alternatively, you can re-launch GSEA and click on: Analysis history, then History and then navigate to date of your analysis. Although all analyses, regardless of where the results files were saved, are listed under history, they are organized by the date the analyses were run. If you cannot remember when you ran a specific analysis, then you may have to manually search through a few directories to find the desired analysis A. Web page summary of GSEA results showing pathways enriched in the top or bottom of the ranked list, with the ‘na_pos’ and ‘na_neg’ phenotypes corresponding to enrichment in upregulated and downregulated genes, respectively. These have been manually labeled here as mesenchymal and immunoreactive, respectively. A. An example enrichment plot for the top pathway in the mesenchymal set. A. An example enrichment plot for the top pathway in the immunoreactive set. In the web browser results summary, click on the Snapshot link under the results to get an overview of the top 20 findings. The most significant pathways for the first phenotype (‘na_pos’) should clearly display enrichment in top-ranking (i.e., upregulated) genes (left side of the plot). Conversely, the most significant pathways for the second phenotype (‘na_neg’) should clearly display enrichment in bottom-ranked (i.e., downregulated) genes (right side of the plot) When running GSEA with expression data as input (instead of a pre-calculated rank file), a phenotype label (i.e., biological condition or sample class) is provided as input for each sample and specified in the GSEA ‘cls’ file. When running GSEA, the two phenotypes to compare for differential gene expression analysis are specified and these phenotypes are used in the pathway enrichment result files. By contrast, in a GSEA preranked analysis (i.e., when a ranked gene list is provided by the user), GSEA automatically labels one phenotype ‘na_pos’ (corresponding to enrichment in the genes at the top of the ranked list, where ‘na’ means the phenotype label is ‘not available’) and the other ‘na_neg’ (corresponding to enrichment in the genes at the bottom of the ranked list). This convention is also used by the EnrichmentMap software, designating the first phenotype as ‘positive’ and the second phenotype as ‘negative’. Class/phenotype-specific GSEA output in the web page summary shows how many gene sets were found enriched in upregulated genes, regardless of significance (purple), the total number of gene sets used after size filtering (cyan), the phenotype name (red) and the number of gene sets that pass different thresholds (orange). In the web browser results summary, click on Detailed enrichment results in HTML format and use the row numbering to check the number of pathways that have FDR Q values &lt;0.05 to determine appropriate thresholds for EnrichmentMap in the next step of the protocol. If no pathways are reported at Q &lt; 0.05, more lenient thresholds such as Q &lt; 0.1 or Q &lt; 0.25 could be used. The threshold Q &lt; 0.25 provides very lenient filtering, and it is not uncommon to find thousands of enriched pathways at this level. Robust analyses should use a cutoff of Q &lt; 0.05 or lower. Filtering only by uncorrected P values is inappropriate and not recommended. Few or no results returned by GSEA Check the number of gene sets that were analyzed. If the number is low (e.g., low hundreds), it could indicate gene ID mapping problems References "],
["visualization-of-enrichment-results-with-enrichmentmap.html", "(7-9) Visualization of enrichment results with EnrichmentMap", " (7-9) Visualization of enrichment results with EnrichmentMap Step 7 - Launch the Cytoscape software. Introductory Cytoscape tutorials can be found at http://tutorials.cytoscape.org. Step 8 - In the menu, click Apps → EnrichmentMap. Step 9 - The Create Enrichment Map panel will appear. Creation of enrichment maps with g:Profiler (option A) and GSEA (option B) requires different input files. Other than the specific input files, the parameters are the same for the two analysis types. Attributes surrounded by a dashed box should be filled out automatically if the user selects an appropriate folder with the required files. Missing file names indicate that EnrichmentMap was unable to find the specified file. Orange boxes indicate optional files. For the examples presented in the protocol, optional files are used for the GSEA analysis but not for the g:Profiler analysis to demonstrate the two distinct use cases. EM, EnrichmentMap. g:Profiler - Creation of enrichment maps for results generated in Step 6A GSEA - Creation of enrichment maps for results generated in Step 6B "],
["gprofiler-em.html", "(9A) g:Profiler - Creation of enrichment maps for results generated in Step 6A Parameter specification Specification of additional optional files: Tuning parameters", " (9A) g:Profiler - Creation of enrichment maps for results generated in Step 6A Step 9A - Parameter specification In the Create Enrichment Map panel, click on folder icon. Locate and select your result data folder containing the g:Profiler results and click on Open. Autoload of g:Profiler results creates many datasets with incorrect file specifications There are too many text files within the directory specified. To simplify loading g:Profiler results into EnrichmentMap and populating the correct fields in the EnrichmentMap interface, place the g:Profiler results file and gene set file (i.e., Supplementary_Table4_gprofiler_results.txt and Supplementary_Table5_hsapiens.pathways.NAME.gmt) into a directory together by themselves. See Example here In the right-hand pane, g:Profiler output files will be automatically populated into their specified fields. Alternatively, users can click on the ‘+’ symbol to specify each of the required files manually. In the right-hand pane, modify the Name of the created dataset if desired. By default, EnrichmentMap will use the name of the g:Profiler enrichment results file (e.g., ‘Supplementary_Table4_gprofiler_results.txt’). Verify that the Analysis Type is set to Generic/gProfiler/Enrichr. Verify the Enrichments results file is the g:Profiler file downloaded in Step 6A(xi) (or alternatively, manually specify ‘Supplementary_Table4_gprofiler_results.txt’). Verify the GMT specified is the file retrieved from the g:Profiler website in Step 6A(xii). Use the file ‘hsapiens.pathways.NAME.gmt’ (or alternatively manually specify ‘Supplementary_Table5_hsapiens.pathways.NAME.gmt’) that contains the gene sets corresponding to GO biological processes and Reactome pathways. Specification of additional optional files: Expressions. (Optional) Upload an expression matrix for the genes analyzed in g:Profiler or, alternatively, upload an expression dataset of all genes. If the expression dataset contains additional genes not used for the g:Profiler search, their expression values will still appear in the heat map of the enrichment map (for an example file, see Supplementary Table 6). Ranks. (Optional) Ranks for the gene list or the expression data can be specified (for an example, see Supplementary Table 2). Classes. (Optional) This is a GSEA CLS file defining the phenotype (i.e., biological conditions) of each sample in the expression file; for an example, see Supplementary Table 7. This file is required only for phenotype randomization in GSEA; however, providing it to EnrichmentMap will label the columns of the expression file in the EnrichmentMap heat map viewer by phenotype. Phenotypes. (Optional) If there are two different phenotypes in the expression data, update the phenotype labels so that ‘positive’ represents the phenotype associated with positive values (mesenchymal in this example) and ‘negative’ represents that associated with negative values (immunoreactive in this example). Using phenotypes with g:Profiler analyses Although an individual g:Profiler analysis has only one phenotype, it is possible to modify a single results file to contain two analyses. This is relevant when the phenotypes are mutually exclusive. For the analysis you want to associate with the additional phenotype (which would correspond to downregulated genes in GSEA PreRanked, thus called ‘negative’) open the g:Profiler results file (preferably in a spreadsheet, so you can easily modify a single column). The fifth column specifies the phenotype. Update the column to have the value of ‘−1’ for each result in the file. Open the second analysis file. Copy all the results from the second file and paste them into the updated negative g:Profiler file. Save the file and use it as the g:Profiler enrichment results file in the EnrichmentMap interface instead of the original results files. Pathways corresponding to two phenotypes will be colored red and blue in the resulting enrichment map. One limitation with this approach is that a pathway cannot be included in both the positive and the negative sets. Tuning parameters Number of Nodes. By default, g:Profiler returns only statistically significant results (Q &lt; 0.05), so the FDR q-value cutoff parameter can be set to 1 in the EnrichmentMap Input panel, unless a more stringent filtering is desired. For this protocol, set the FDR Q value to 0.001. (Optional) Select Filter genes by expressions to exclude any genes in the gene set definition file (i.e., the GMT file) that are not found in the supplied expression file. If Filter genes by expressions is not selected, any gene that is not found in the expression file will be retained and will be presented in the expression heat map viewer with all of its associated expression values grayed out. Number of Edges. Keep the connectivity slider in the center. If the network is too cluttered because of too many connections (edges), move the slider to the left to make the network sparser. Alternatively, if the network is too sparse (i.e., there are too many disconnected pathways), move the slider to the right to obtain a more densely connected network. Moving the slider to the left (or right) will adjust the underlying similarity statistic threshold to make the resulting network sparser (or denser). The slider is set with predefined defaults, but users can fine-tune the similarity metric by selecting Show advanced options at the bottom of the Create Enrichment Map panel. Predefined values appear as tick marks on the slider and include: Jaccard &gt; 0.35, Jaccard &gt; 0.25, combined &gt; 0.375, overlap &gt; 0.5, and overlap &gt; 0.25. Click the Build button at the bottom of the EnrichmentMap Input panel. A Building EnrichmentMap box appears and indicates the progress status. This box will disappear once the map has been created successfully. the resulting enrichment maps from the g:Profiler analysis. "],
["gsea-em.html", "(9B) GSEA - Creation of enrichment maps for results generated in Step 6B Parameter specification Specification of additional optional files: Tuning parameters", " (9B) GSEA - Creation of enrichment maps for results generated in Step 6B Step 9B - Parameter specification In the Create Enrichment Map panel, click on folder icon and locate the GSEA results folder created in Step 6B . Click on the GSEA folder to select it. Click on Open. If you specify a directory that contains multiple GSEA results, rather than an individual GSEA results folder, EnrichmentMap will treat each GSEA results folder as a separate dataset. This enables easy multi-dataset analyses. If you want only one dataset but inadvertently selected the directory containing multiple GSEA results instead of selecting an individual folder, simply select the datasets you do not want to use and click on the trash can at the top of the EnrichmentMap input panel to remove them. If you specify a directory for Enrichment to auto populate your files for you this will result in the following parameters being filled: When GSEA results are generated from preranked gene list there is no expression file associated with the GSEA results and EM will automatically put the ranked list as the expression file. Make sure to update the it if you have an expression file associated with the analysis. The ranks will still be loaded as well through the RNK file parameter. In the right-hand pane, GSEA output files will be automatically populated into their specified fields. Alternatively, users can click on the ‘+’ symbol to specify each of the required files manually. In the right-hand pane, modify the Name of the created dataset if desired. By default, EnrichmentMap will use the first part of the GSEA folder name before the last dot (.) to create the dataset name. For example, if the directory is called Mesen_vs_Immuno.GseaPreranked.12345, the name will be populated as Mesen_vs_Immuno.GseaPreranked. Verify that the Analysis Type is set to GSEA. Enrichments Pos. Verify that the file name is set to ‘[your_path_to_gsea_dir]/Mesen_vs_Immuno.GseaPreranked.12345/gsea_report_for_na_pos_12345.xls’, where ‘12345’ is a unique number generated by GSEA. Alternatively navigate to the ‘Supplementary_Table8_gsea_report_for_na_pos.xls’ file. Enrichments Neg. Verify that the file name is set to ‘[your_path_to_gsea_dir]/gsea_report_for_na_neg_12345.xls’, where ‘12345’ is a unique number generated by GSEA. Alternatively navigate to the file ‘Supplementary_Table9_gsea_report_for_na_neg.xls’. ** A random number is appended to the GSEA directory name** Each GSEA analysis generates a random number that is appended to the names of the files and directories. The number will be different for each new analysis GMT. Verify that the file name is set to ‘Supplementary_Table3_Human_GOBP_AllPathways_no_GO_iea_July_01_2017_symbol.gmt’. Alternatively, navigate to the file ‘Supplementary_Table3_Human_GOBP_AllPathways_no_GO_iea_July_01_2017_symbol.gmt’. EnrichmentMap uses a GMT file that was not the original file input to GSEA The original GMT file was moved or no longer exists in the location in which GSEA saved it. If EnrichmentMap cannot find the original GMT file used in the GSEA analysis, it will use a filtered GMT file found in the GSEA ‘edb’ results directory. EnrichmentMap will not be able to find your original GMT file if you have moved it since running GSEA analysis. Although it is a GMT file, it has been filtered to contain only genes found in the expression file. If you use this filtered file, you will obtain different pathway connectivity depending on the expression data being used. You should always use the original GMT file used for the GSEA analysis and not the filtered one in the results directory Ranks. Verify that the file name is set to ‘ranked_gene_list_na_pos_versus_na_neg_12345.xls’, where ‘12345’ is a unique number generated by GSEA. Alternatively, navigate to the ‘Supplementary_Table2_MesenvsImmuno_RNASeq_ranks.rnk’ file. Specification of additional optional files: Expressions. (Optional) Upload an expression matrix for the genes analyzed in GSEA. For an example file, see ‘Supplementary_Table6_TCGA_OV_RNAseq_expression.txt’. Classes. (Optional) This is a GSEA CLS file defining the phenotype (i.e., biological conditions) of each sample in the expression file; for an example, see Supplementary Table 7. This file is required only for phenotype randomization in GSEA; however, providing it to EnrichmentMap will label the columns of the expression file in the EnrichmentMap heat map viewer by phenotype. Phenotypes. (Optional) In the text boxes replace, ‘na_pos’ with ‘Mesenchymal’ and ‘na_neg’ with ‘Immunoreactive’. ‘Mesenchymal’ will be associated with red nodes because it corresponds to the positive phenotype, whereas ‘Immunoreactive’ phenotypes will be labeled blue. If you load the CLS file before specifying the phenotypes, EnrichmentMap will automatically guess the phenotypes from the class file. If your class file specifies more than two phenotypes, EnrichmentMap will choose the first two phenotypes defined in the file. To annotate the phenotypes in the EnrichmentMap heat map, the specified phenotype labels need to exactly match the GSEA CLS file. Tuning parameters Number of Nodes. Set the FDR Q value cutoff to 0.01. (Optional) Select Filter genes by expressions to exclude any genes in the gene set definition file (i.e., the GMT file) that are not found in the supplied expression file. If Filter genes by expressions is not selected, any gene that is not found in the expression file will be retained and will be presented in the expression viewer with all of its associated expression values grayed out. User cannot provide a sufficiently precise Q value To set the threshold to a small number, select Scientific Notation and set a Q value cutoff such as 1E−04 Number of Edges. Keep the connectivity slider in the center. To create networks with fewer edges,(a sparser network), move the slider to the left. Alternatively, to create networks with more edges (a denser network), move the slider to the right. Moving the slider to the left (or right) will adjust the underlying similarity statistic threshold to make the resulting network sparser (or denser). The slider is set with predefined defaults, but users can fine-tune the similarity metric by selecting Show advanced options at the bottom of the Create Enrichment Map panel. Predefined values appear as tick marks on the slider and include: Jaccard &gt; 0.35, Jaccard &gt; 0.25, combined &gt; 0.375, overlap &gt; 0.5, and overlap &gt; 0.25. Click the Build button at the bottom of the EnrichmentMap Input panel. A Building EnrichmentMap box appears and indicates the progress status. This box will disappear once the map has been created successfully. the resulting enrichment maps from the GSEA analysis. "],
["navigation-and-interpretation-of-the-enrichment-map.html", "(10-12) Navigation and interpretation of the enrichment map", " (10-12) Navigation and interpretation of the enrichment map An enrichment map must be interpreted to discover novel information about a dataset and must be manually refined to create a publication-quality figure. To explore the enrichment map, select the network of interest in the Control Panel located at the left side of the Cytoscape window. Cytoscape ‘Control Panel’, which contains ‘Networks’, ‘Styles’ and ‘Select’ tabs as well as the ‘EnrichmentMap’ main panel. The ‘Table Panel’ contains tables with node, edge and network attributes, as well as an enrichment map ‘Heat Map’ panel displaying expression for genes associated with selected nodes and edges. Cytoscape search bar, which can be used to search for genes in the enrichment map. ‘Node Table’ containing values for all variables associated with each node in the network. Q-value or P-value slider bar. By default, the slider is set to Q value if the data contains Q values but can be changed to use P values by selecting the ‘P-value’ radio button. All nodes that pass the initial Q-value threshold are displayed in the enrichment map. By moving the slider to the left, the Q-value threshold is adjusted to a lower value, removing any nodes that do not pass the Q-value threshold. The currently set threshold will be displayed in the accompanying text box. Thresholds can be manually adjusted by modifying the text box value directly. ‘Edge Cutoff (Similarity)’ slider bar. The slider bar modifies the similarity threshold. The similarity threshold can only be increased; i.e., edges are required to have more genes in common in order to remain visible, which will remove edges from the network that do not satisfy the threshold. One can also manually change the threshold by modifying the text box value directly. The Network Panel can be selected using the top most tab of the Control Panel. The selected network will appear in the main window; navigate to it (zoom and pan) using Cytoscape controls, and explore the pathways by reading the gene set labels. Pathways with many common genes often represent similar biological processes and are grouped together as sub-networks or themes in the network. Click on a node to display the corresponding genes in the table below the network view. Few or no pathways are present in EnrichmentMap A pathway enrichment analysis resulting in few or no enriched pathways may be caused by suboptimal statistical processing used to define the original gene list. Enriched pathways are unlikely to be found if the gene list ranks are too noisy and the most important genes are not at the top of the list, no genes are highly significant, or a large fraction of genes are highly significant. If the gene list has been correctly defined, analyzing further databases of pathways and gene sets or setting more liberal filters may improve results To find a gene or pathway of interest, type its name in the search bar located in the top right corner. All pathways containing that gene will be highlighted. For example, TP53 and BGN are the top genes in g:Profiler and GSEA analyses, respectively. User cannot find any pathways with search gene Multiple genes separated by spaces can be entered into the search bar. Any pathway that contains the gene will be selected and highlighted in the network. Adding keywords with ‘AND’ into the search bar will show only pathways that contain all genes in the search query (e.g., ‘geneA AND geneB’). If the original analysis did not use gene symbols, then you will not be able to search by gene symbols. Instead, use the identifier type that the analysis was based on, for example Entrez Gene ID or Ensembl gene ID To find the most enriched pathways: look at the Table Panel located below the network view. Select the Node Table tab , and Select and sort the column named ‘EM#_fdr_qvalue’ (for g:Profiler) or ‘EM#_NES’ (for GSEA) by clicking on the column header. To highlight a subset of these pathways in the network, select rows corresponding to the pathways of interest, right-click on any selected row in the table and select Select nodes from selected rows. You can reduce the number of columns displayed in the Node table by changing the selected columns by clicking on the column icon in the Table viewer. By default all the enrichment map columns are selected. There are very few entries in the node table, although the network contains many nodes If there are very few records in the node table, make sure that no nodes are selected in the network. Or click on the gear icon and change the setting from Auto to Show all Depending on the focus of the analysis, there are different actions that can be taken on the resulting enrichment map. Follow option A to explore the Table Panel heat map; option B to organize and clarify the network; option C to define major biological themes; option D to create a simplified network view; option E to manually arrange the network nodes; and option F to create a subnetwork that highlights a specific theme subset. * Skip ahead to Step 14 to save the image and to generate legends. "],
["a-exploring-the-table-panel-heat-map.html", "(13A) Exploring the Table Panel heat map Expression Viewer Sorting options Gene Options Expression data transformations Additional Functions Export Results", " (13A) Exploring the Table Panel heat map Expression Viewer i.When a gene expression matrix is provided as input to EnrichmentMap, we can study the expression pattern of the genes included in enriched pathways. Click on either an individual node - or a group of nodes - to generate a gene expression heat map that will appear in the Heat Map tab of the Table Panel. If the analysis is based on GSEA results and a rank file is supplied, the ‘leading edge’ genes will be highlighted in yellow for individual node selections. Several options for heat map visualization are available. If no expression file is provided to EnrichmentMap as input, it will automatically create a dummy expression file in which any gene found in the enrichment file will be given a placeholder expression value of 0.25, and any gene found in a pathway but not found in the enrichment results file will be assigned a placeholder expression value of ‘NA’ (not applicable). Therefore, clicking on any node in the enrichment map will show the genes used for the analysis as well as genes in the pathway that are not part of the query set. Sorting options Adjust the Sort option. Sorting options include: hierarchical clustering, ranks or clicking on any of the column headers in heatmap will sort by that column To change the sorting option: click on the Sort button visible in the top left corner of the heat map table. By default, the heat map is sorted by ranks if a rank file is supplied. In the absence of a rank file, no sort is applied. Additional rank files can be uploaded for comparison through the Settings menu located at the top right corner in the Heat Map panel. Choosing which rank file to sort from can be done by clicking on the Sort button and selecting the rank file by name. Click the arrow next to the currently sorted column to invert the sort order. Click any of the column names to sort the selected column. User does not know which sort option to choose In the case of multiple conditions or conditions with variable expression profiles (e.g., cancer patient samples), hierarchical clustering tends to generate a more informative visualization Gene Options Define Genes you wish to visualize in the heat map Data can be viewed for all genes contained in the selected nodes (union of nodes) or just for the genes common to selected nodes (intersection of nodes). By default, all genes are shown. Expression data transformations Change the Expressions value visualization depending on your data type Data can be viewed: as they were loaded (Values), as row-normalized, in which case the row mean is subtracted from each value and then divided by the row’s standard deviation (Row Norm), or as log-transformed (Log). By default, set to (Values). Compress heat map columns By default, all expression values are visible as individual columns in the heat map for expression sets with &lt;50 samples. It is possible to compress the data into a single column by selecting one of the aggregation methods: Dataset - Median, Dataset - Max (maximum) or Dataset - Min (minimum) —listed under Compress. If a CLS file has been uploaded, the expression set can be compressed using one column per defined sample group using the Class option. Class - Median, Class - Max (maximum) or Class - Min (minimum) Dataset - Median, Dataset - Max (maximum) or Dataset - Min (minimum) If the expression matrix contains ≥50 samples, EnrichmentMap will automatically compress the values to their Dataset median value by default. Check Values to show the expression numerical values in addition to the heat map color scale. Additional Functions Perform additional fine-tuning of the heat map using the Settings panel, accessed by clicking on the menu icon This includes functionality to: Show in GeneMANIA... - Use the genes in the heatmap and search GeneMANIA(Warde-Farley et al. 2010). Show in STRING ... - Use the genes in the heatmap and search STRING. Show in Pathway Commons... - Use the genes in the heatmap and search Pathway Commons. Add Rankings - add new ranking files, Export as TXT... - export the heat map data as a tab-delimited text file Export as PDF... - export the heat map data as a PDF image, change the distance metric for hierarchical clustering, Auto-focus HeatMap - turn on the node table heat map auto focus. Sync Data Sets with Control Panel Display only selected Data Sets - when using multiple datasets there can be many expression files. By default the heat map will only show the expression files of the selected dataset but if you would like to see them all then you can change this setting. Auto Select leading edge Genes are sorted using the GSEA rank file, highlighting the leading edge in yellow. All genes contained in selected nodes are shown, expression values are row-normalized, no compression is applied and individual expression numerical values are not shown. Column headings are colored according to sample phenotype. Red color refers to the first phenotype (mesenchymal), and blue to the second phenotype (immunoreactive). Heat map column names are not colored by dataset If the heat map columns are not colored for a GSEA analysis, make sure the phenotype names specified in the EnrichmentMap input panel here: match the class names specified in the class file Supplementary_Table7_TCGA_OV_RNAseq_classes.cls. Export Results The heat map can be exported to a text file for further analysis: click on the Settings icon of the heat map and select Export as TXT. If only an individual node is selected, a dialog will offer to export the Leading edge only for GSEA analysis. If selected, only the highlighted genes will be exported; otherwise, the entire set of genes is saved. The option to save only leading-edge genes is not available Selection includes more than one node or dataset contains no leading-edge information (i.e., was not built from GSEA results The leading edge is available only for GSEA analyses. The option will appear only if the enrichment map was built with GSEA results and a rank file was specified Specify the file name and location and click Save. References "],
["genemania.html", "Search GeneMANIA Show connections between genes in Gene set using GeneMANIA Update GeneMANIA visual style Explore GeneMANIA network", " Search GeneMANIA This function allows users to search GeneMANIA(Warde-Farley et al. 2010) with a set of genes. The genes are pulled from the selected nodes in the Enrichment map but can be adjusted by the user before initiating the query. Show connections between genes in Gene set using GeneMANIA The show in GeneMANIA function can be accessed from the HeatMap settings menu as well as the Right click context menu in the network. Right click on selected node/nodes. Select Apps --&gt; EnrichmentMap - Show in GeneMANIA A GeneMANIA Query panel will show up for the user to adjust query parameters. Genes - The genes are pulled from all the selected nodes. You can choose to change the selection to a subset of genes in the set by unclicking specific genes. If available, clicking on &quot;Select leading edge&quot; will limit the gene selection to just genes in the leading edge for the selected gene set. Option will only be available for GSEA results where only a single gene set is selected. Organism - select organism genes are associated with. Max Resultant genes - the GeneMANIA algorithm looks for similar genes to the query set. To see the connections of just the query genes set the max resultant genes to zero (default). By increasing this threshold GeneMANIA will add similar genes to the resulting network. Network Weighting - GeneMANIA is a network weighting algorithm where by it weighs it available networks such that it maximizes the connections between the query set of genes. Resulting GeneMANIA network using the genes from the selected node &quot;Interferon alpha beta signaling&quot;. Update GeneMANIA visual style You can change the visual properties of GeneMANIA network through the panel created by Enrichment map. By default, the GeneMANIA network has the default GeneMANIA style. Adjust style with Enrichment Map expression data using the panel. The panel contains the similar features that are available in the Enrichment Map heatmap panel. Chart Data - choose to colour by dataset or by expression data. Expressions - if chart data is set to 'Color by Expression Data' choose from Values, Row Norm or log values. Compress - if chart data is set to 'Color by Expression Data' choose from Class: Median, Class: Min, Class: Max, Dataset: Median, Dataset:Min, Dataset: Max, or None Chart type - if chart data is set to 'Color by Expression Data' choose from Radial HeatMap or Heatstrips. Data Set - if there are multiple datasets choose which dataset to colour by. Resulting GeneMANIA network using the genes from the selected node &quot;Interferon alpha beta signaling&quot; after colouring the GeneMANIA network with expression data from Enrichment Map. If you want to return to your Enrichment map click on the drop down in the top of the Control panel and By default, the GeneMANIA network will be named by the species you are searching in. For example, if you are searching in Homo Sapiens the network will be called H. Sapiens (1). For each new search in the same species the number in parenthesis will be increased. jump back to the original enrichment map by selecting it from the drop down list.(For our example, click on mesen_vs_immuno.GSEAPreRanked to go to the original network.) Explore GeneMANIA network GeneMANIA(Warde-Farley et al. 2010) returns the inter-connected network of query genes connected using various types of networks including: Co-expression Pathways Shared protein domains Physical interactions Predicted Co-localizations You can see the weights associated with your query genes in the Cytoscape results panels located on the right hand side. If the panel is not there, click on the GeneMANIA icon on the left hand bar to open it. Each network type contains hundreds of different networks and each network is associated with its own weight that contributes to the weight of the group. You can expand each network type to see the individual networks. Clicking on an individual network or network type will highlight all the nodes and edges that are associated with it. References "],
["pathwaycommons.html", "Search Pathway commons Show pathway connections between genes in Gene set using Pathway commons", " Search Pathway commons This function allows users to search Pathway Commons(Rodchenkov et al. 2020) with a set of genes. The genes are pulled from the selected nodes in the Enrichment map but can be adjusted by the user before initiating the query. Pathway commons integration needs expression data to work properly. If you have created an enrichment map without an expression set no network will be created in pathway commons. Show pathway connections between genes in Gene set using Pathway commons The show in Pathway Commons function can be accessed from the HeatMap settings menu as well as the Right click context menu in the network. Right click on selected node/nodes. Select Apps --&gt; EnrichmentMap - Show in Pathway Commons Pathway commons will automatically launch in your web browser showing you the pathway that best matches your query. Genes in the pathway diagram that are coloured indicate the gene was found in the enrichment map. The colour indicates the degree of differential expression. You can change the value of differential expression by adjusting the collapsing method in the right hand legend panel. Pathway commons will attempt to find the best pathway that matches the set of genes that are passed to it. Not all pathways are represented in pathway commons (and some are not based on formal pathway definitions, for example biological process from the gene ontology). If the pathway chosen is not the best representation of the set of genes you queried you can manually choose between the other matches. In the right hand legend panel select the Select Pathways tab. Scroll through results to find the best pathway. Each pathway lists: pathway name pathway database source number of genes from enrichment map query that matched pathway. Clicking on any of the pathways in the list will open a new tab with the selected pathway. References "],
["string.html", "Search String Show connections between genes in Gene set using STRING Update STRING visual style Explore STRING network", " Search String This function allows users to search STRING(Szklarczyk et al. 2019) with a set of genes. The genes are pulled from the selected nodes in the Enrichment map but can be adjusted by the user before initiating the query. Show connections between genes in Gene set using STRING The show in STRING function can be accessed from the HeatMap settings menu as well as the Right click context menu in the network. Right click on selected node/nodes. Select Apps --&gt; EnrichmentMap - Show in STRING A STRING Protein Query panel will show up for the user to adjust query parameters. Genes - The genes are pulled from all the selected nodes. You can choose to change the selection to a subset of genes in the set by unclicking specific genes. If available, clicking on &quot;Select leading edge&quot; will limit the gene selection to just genes in the leading edge for the selected gene set. Option will only be available for GSEA results where only a single gene set is selected. Organism - select organism genes are associated with. Confidence cutoff - the STRING algorithm looks for interactions between the query set. Different interactions have different confidence scores depending on many different factors (experiment through which it was found, number of publications associated with it ....). By default, the confidence cutoff is set to 0.40. To decrease the number of interactions returned, and include only high confidence interactions you can increase this threshold. The inverse, decreasing the cutoff, will return more interactions. Max Additional Interactors - If you want to add interactors in addition to your query you can specify the number of interactors you want STRING to return. Resulting STRING network using the genes from the selected node &quot;Interferon alpha beta signaling&quot;. Update STRING visual style You can change the visual properties of STRING network through the panel created by Enrichment map. By default, the STRING network has the default STRING style. There is a lot of information embedded in this view. See here for a tutorial on using STRING. Adjust style with Enrichment Map expression data using the panel. The panel contains the similar features that are available in the Enrichment Map heatmap panel. Chart Data - choose to colour by dataset or by expression data. Expressions - if chart data is set to 'Color by Expression Data' choose from Values, Row Norm or log values. Compress - if chart data is set to 'Color by Expression Data' choose from Class: Median, Class: Min, Class: Max, Dataset: Median, Dataset:Min, Dataset: Max, or None Chart type - if chart data is set to 'Color by Expression Data' choose from Radial HeatMap or Heatstrips. Data Set - if there are multiple datasets choose which dataset to colour by. Resulting STRING network using the genes from the selected node &quot;Interferon alpha beta signaling&quot; after colouring the STRING network with expression data from Enrichment Map. If you want to return to your Enrichment map click on the drop down in the top of the Control panel and By default, the STRING network will be named String Network. For each new search a number will be added to the end of the name. You can manually change the name of the network by right clicking on the network name and selecting Rename in the Network Panel. jump back to the original enrichment map by selecting it from the drop down list.(For our example, click on mesen_vs_immuno.GSEAPreRanked to go to the original network.) Explore STRING network STRING(Szklarczyk et al. 2019) returns the inter-connected network of query genes connected based on the interactions and associated scores pulled from the STRING database. The returned STRING network has the typical STRING &quot;glass&quot; look style which can be easily adjusted using the option in the STRING panel (on the right hand side). Disabling all visual properties will generate a simple network STRING Enrichments Eventhough the network was created from an enrichment analysis, STRING allows you to run an enrichment analysis on all or some of the genes in the network. There are two types of enrichments available: Functional Enrichments - genes in the STRING network that are enriched in annotations from GO Biological process, GO molecular function, GO cellular component, Reactome pathway, KEGG pathway, Interpro domains, SMART domains, and Uniprot Key words Click on Functional Enrichment If you want to restrict to just the selected node then click on &quot;retrieve for selected nodes only&quot; You can also choose to use different background sets for the functional enrichment test, the entire genome, or limit it to the genes in the network. Click on OK. Enrichment results will appear in the Table browser. Enriched Publications - genes in the STRING network that are enriched for a given publication. Click on Enriched Publications If you want to restrict to just the selected node then click on &quot;retrieve for selected nodes only&quot; You can also choose to use different background sets for the functional enrichment test, the entire genome, or limit it to the genes in the network. Click on OK. Enrichment results will appear in the Table browser. STRING filtering STRING offers interesting annotations and filter options. You can filter your results by: Tissue types Cellular location Moving the sliders for each defined tissue type or cellular location will limit the genes in the network to just the genes that are more strongly associated with the given term. For example, if you want to highlight genes found in the nucleus move the slider next to the nucleus term. Scores associated with each of these can also be found in the Node Table. STRING selected Selecting an individual gene or a group of genes will populate the Selected pane with additional information about all the genes selected References "],
["b-organization-and-clarification-of-the-network.html", "(13B) Organization and clarification of the network Separate two different phenotypes", " (13B) Organization and clarification of the network If the network has too many nodes, go to the EnrichmentMap tab in the Control Panel and use the Node Cutoff Q-value threshold slider. Adjusting to a numerical value closer to 0 will remove less significant nodes. If the network is too interconnected, go to the EnrichmentMap tab in the Control Panel and increase the Edge Cutoff (Similarity) threshold; this will remove connections between less related nodes Apply the network layout again after adjusting the cutoffs (see the Layout menu in Cytoscape). The default layout algorithm is the unweighted Prefuse Force Directed layout. We also recommend that the prefuse force-directed layouts be weighted using the gene set similarity coefficient. Alternative layout algorithms are available and we encourage experimentation with them. There are many different layout algorithms available in Cytoscape that can be used for EnrichmentMap. We recommend using an edge-weighted layout, which considers the overlap score between pathways. Most layouts (except yFiles) offer the ability to organize just the selected nodes. Experiment with different layouts to see which works best with your data. If you do not like the resulting layout, press command-z on macOS or Ctrl-z on Windows or click on Edit → Undo to revert to the previous view. To restore nodes or edges, adjust the threshold sliders to their original positions. Separate two different phenotypes It can be helpful to separate two different phenotypes (i.e., place all the red nodes to one side and all the blue nodes to the other). To do this, go to the Filter tab in the Control Panel. Click on the ‘+’ symbol and select Column filter. Click on Choose column… and select ‘Node: NES (Mesem_vs_Immuno.GseaPreranked)’. Click on the box next to between and change the value to 0. Click Apply at the bottom of the panel. All red nodes should now be selected. Click and hold on any selected node and drag selection to the left until it does not overlap any blue nodes. Select Layouts from the Cytoscape menu and apply Prefuse Force Directed Layout → Selected Nodes Only → (none). Go back to the Control Panel Filtertab and adjust the slider to select all negative values. Click on Apply at the bottom of the Filter tab. All blue nodes should now be selected. Click and hold on any selected node and drag selection to the right until it does not overlap any red nodes. Select Layouts from the Cytoscape menu bar and apply Prefuse Force Directed Layout → Selected Nodes Only → (none). "],
["annotate.html", "(13C) Defining major biological themes Annotate the Network Manually arrange network Resulting Network", " (13C) Defining major biological themes Enrichment maps typically include clusters of similar pathways representing major biological themes. Clusters can be automatically defined and summarized using the AutoAnnotate Cytoscape application. AutoAnnotate (Kucera et al. 2016) first clusters the network using the clusterMaker2 (Morris et al. 2011) application and then summarizes each cluster on the basis of word frequency within the pathway names via the WordCloud (Oesper et al. 2011) app. Annotate the Network From the Cytoscape menu bar, launch AutoAnnotate by selecting Apps → AutoAnnotate → New Annotation Set…. The AutoAnnotate: Create Annotation Set panel will appear. In the Quick Start tab, click on Create Annotations. The default parameters are likely to work well with EnrichmentMap; however, there are many parameters within the AutoAnnotate application that can fine-tune the results. See the AutoAnnotate user manual at https://autoannotate.readthedocs.io/en/latest/ Each cluster in the network will have a circle annotation drawn around it and will be associated with a set of words (by default three) that correspond to the most frequent node labels in the cluster. These words are automatically selected and often must be manually renamed. Moving individual nodes within a cluster will automatically resize the surrounding circle and moving an entire cluster will redraw the surrounding circle in the new cluster location. Node names contain uninformative words that are not excluded by default or are not considered during network normalization If particular non-informative words keep appearing in the labels generated by AutoAnnotate, try adjusting the WordCloud normalization factor. The significance of each word is calculated on the basis of the number of occurrences in the given cluster of pathways. This causes frequent words such as ‘pathway’ or ‘regulation’ to be prominent. By increasing the normalization factor, we reduce the priority of such recurrent words in cluster labels. If that doesn’t help, you can add the non-informative words to the WordCloud word exclusion list Click on Apps -&gt; Word Cloud -&gt; Show Word Cloud Navigate to Word cloud input panel in Cytoscape Control Panel adjust normalization constant slider bar. In the AutoAnnotate input panel, click on the menu button (icon with three horizontal lines). Select Recalculate Labels… for this change to take effect Alternately, you can add the offending words to word cloud ignore list. * Click on Apps -&gt; Word Cloud -&gt; Show Word Cloud * In the WordCloud input panel, expand Advanced options. * Click on Excluded words... * type offending words into text box * Click on Add * Repeat for all words you would like remove * Click on OK * In the AutoAnnotate input panel, click on the menu button (icon with three horizontal lines). Select Recalculate Labels… for this change to take effect Labels contain ‘-’ If a specific character other than a space is used to separate words (e.g., ‘-’ or ‘|’), it should be added as a delimiter in the WordCloud application. Launch the WordCloud application (Apps → WordCloud). In the WordCloud input panel, expand Advanced options. Click on Delimiters… Add your delimiters. Click on OK. In the AutoAnnotate input panel, click on the menu button (icon with three horizontal lines). Select Recalculate Labels… for this change to take effect Manually arrange network Manually arrange clusters to clean up the figure. Move nodes to reduce node and label overlap. Labels are bigger for bigger clusters, but user wants all the labels to be the same size The number of nodes in a cluster determines label size by default. Thus, the cluster size may relate to pathway popularity instead of importance in the experiment. Annotation labels can all be set to the same size by unchecking the option Scale font by cluster size in the AutoAnnotate results panel. Resulting Network Publication-ready enrichment map created with parameters FDR Q value &lt; 0.01, and combined coefficient &gt;0.375 with combined constant = 0.5. Red and blue nodes represent mesenchymal and immunoreactive phenotype pathways, respectively. Nodes were manually laid out to form a clearer picture. Clusters of nodes were labeled using the AutoAnnotate Cytoscape application. A legend was manually added at the bottom of the figure. References "],
["d-creation-of-a-simplified-network-view.html", "(13D) Creation of a simplified network view Collapse Network Scale Network", " (13D) Creation of a simplified network view This creates a single group node for each cluster with a summarized name and provides an overview of the enrichment result themes that is useful for enrichment maps containing many nodes. Collapse Network In the Control Panel, select the AutoAnnotate tab. Click on the Menu icon in the upper right corner. Select Collapse All. Pop-up after selecting Collapse all shows up every time user collapses the clusters Once you click on Collapse All, a pop-up window will show the message ‘Before collapsing clusters please go to the menu Edit → Preferences → Group preferences and select ‘Enable attribute aggregation’’. There is no need to adjust this parameter repeatedly. Click on Don’t ask me again and OK if you have set this parameter previously. Collapsing the network takes a long time For large networks, collapsing and expanding may take time. For a quick view of the collapsed network, you can create a summary network by selecting the Create summary Network… option. There are two options for the summary network: clusters only, which creates a summary network with just the circled clusters, or clusters and unclustered nodes, which creates a summary network that also includes the singleton nodes that are not part of any cluster Collapsed network contains gray nodes instead of colored nodes as they were in the pre-collapsed network If the nodes in the resulting collapsed network are gray, then you forgot to enable attribute aggregation. Expand the clusters and, before collapsing clusters again, go to Edit → Preferences → Group preferences and select Enable attribute aggregation Now, Select Collapse all to collapse network. The enrichment map was summarized by collapsing node clusters using the AutoAnnotate application. Each cluster of nodes s now represented as a single node. Scale Network Scale the collapsed network for better viewing. In the Cytoscape menu bar, select View → Show Tool Panel. Go to the Layout Tools panel located at the bottom of the Control Panel. Locate the Scale slider bar and use it on unselected nodes (uncheck Selected only). Move the slider left to tighten the node spacing. Close the Node Layout Tools panel when finished. "],
["e-manual-arrangement-of-network-nodes-and-updating-of-theme-labels.html", "(13E) Manual arrangement of network nodes and updating of theme labels Create Sub-network Publication ready Rename themes", " (13E) Manual arrangement of network nodes and updating of theme labels This section is required for the clearest network view and for a publication-quality figure. For instance, it is useful to bring together similar themes, such as signaling or metabolic pathways, even if they are not connected in the map. Use of space should be optimized so that large amounts of white space are not present. This is a time-consuming step, but the more effort spent, the higher the quality of the resulting figure will be. Create Sub-network If the focus of the figure is only on a subset of the network, it can be easier to work with just the subset. To create this, select the nodes of interest, then in the Cytoscape menu bar select File → New → Network → From selected nodes → all edges, or alternatively use the corresponding icon in the Cytoscape tools menu bar (New network from selection → all edges). Publication ready When the purpose of the figure is to show a large network and highlight only the main themes, click on Publication ready, located at the bottom of the EnrichmentMap in the Control Panel to remove node labels. To revert to the original network, click on the Publication ready button again. In the EnrichmentMap input panel, the bottom options Publication Ready and Set Signature Edge Width are not visible Close the Layout Tools window clicking on the Layout Tools icon in the side menu. Rename themes Rename the theme names generated by AutoAnnotate to better explain groups of pathways. Automatic WordCloud-generated theme names are useful for quickly exploring an enrichment map, but frequently need to be renamed for publication-quality figures. Naming should carefully consider all pathways and genes within each theme. Themes can be renamed in AutoAnnotate by right-clicking the name in the AutoAnnotate panel in the ‘Cluster’ column, and selecting Rename… Alternatively, labels can be changed in external drawing software (follow Steps 14–16 to export a file to use in external drawing software). Note that re-clustering the network will reset the theme names. "],
["f-creation-of-a-subnetwork-that-highlights-a-specific-theme-subset.html", "(13F) Creation of a subnetwork that highlights a specific theme subset", " (13F) Creation of a subnetwork that highlights a specific theme subset Enrichment maps of rich omics datasets are often large and complicated, and it is often useful to emphasize specific themes or relevant pathways in a final figure. For example, we will select the top mesenchymal and immunoreactive pathways and create a subnetwork for detailed visualization. Subnetwork of the main enrichment map was manually created by selecting pathways with the top NES values and creating a new network from the selection. Red and blue nodes are mesenchymal and immunoreactive phenotypes, respectively. Clusters of nodes were automatically labeled using the AutoAnnotate application. Annotations in the subnetwork may differ slightly from those in the main network, as word counts were normalized on a network basis. Click on the Filter tab in the Control Panel Click on the ‘+’ symbol and select Column filter. Click on Choose column… and select ‘Node: NES (Mesem_vs_Immuno.GseaPreranked)’. Click on the box next to between and replace the negative value with ‘2.5’. Do not change the positive value next to inclusive. Click Enter. Click on the ‘+’ symbol and select Column filter. Click on Choose column… and select ‘Node: NES (Mesem_vs_Immuno.GseaPreranked)’. Click on the box next to inclusive and change the value to ‘-2.5’. Do not change the negative value next to between. Click Enter. Above the two column filters you just added, change the dropdown option from Match all (AND) to Match any (OR). Click on Apply. Under the Apply button, it should display the number of nodes and edges selected. In this example, 37 nodes should be selected. From the Cytoscape menu, choose Select File → New → Network → From selected nodes, all edges. or click on the button in the menu bar The created subnetwork is empty Make sure that the nodes that will be part of the subnetwork are selected before creation of the subnetwork A new, smaller network should appear. Manually move nodes around to optimize the layout. Annotate the network as described in Step 13C "],
["exporting-figures-creating-legends-and-saving-work.html", "(14 - 20) Exporting figures, creating legends and saving work Export image Save Network Network creation parameters Legends Save", " (14 - 20) Exporting figures, creating legends and saving work Export image Export network as image. In the Cytoscape menu bar, select File → Export as Image… Set the Export File Format to PDF (*.pdf). Vector-based PDF and SVG formats are recommended for publication-quality figures because they can be zoomed without losing quality. Either file type can be edited using software packages such as Adobe Illustrator or Inkscape. The PNG file format is recommended for high-quality online images, whereas the JPG format is not recommended because it may lead to visual artifacts due to lossy compression. Exported image contains only a small subset of the network In image export, only the visible part of the map will be exported. Make sure that the entire network is visible on your screen before exporting Save Network Click on Browse… to specify file name and location. Click on Save to close the browser window and then on OK. Network creation parameters Identify network creation parameters. In the previous step, we exported the network as an image, but the parameters used to create the map are needed to interpret and reproduce the image. In the Control Panel, locate the EnrichmentMap input panel and click on the menu icon in the top right-hand corner. Click on Show Creation Parameters. In the displayed panel, you will find the FDR Q value, similarity metric and threshold parameters to be added to the text legend of figure. In this example: ‘Enrichment map was created with parameters q &lt; 0.01, and Jaccard Overlap combined coefficient &gt; 0.375 with combined constant = 0.5’ The EnrichmentMap Creation Parameters panel shows only the parameters that were used at network creation. If you modified the network using filters or the EnrichmentMap slider bars, you will have to update the thresholds accordingly. Legends Show and create a legend. In the Control Panel, locate the EnrichmentMap input panel and click on the menu icon in the top right corner. Click on Show Legend. The example shows a simplified legend; however, many different node and edge attributes, such as size, shape and color, can be used in the enrichment map to represent different aspects of the data. It is important to describe them in the text associated with the figure or in the figure itself as a legend. The basic legend components (available as SVG and PDF images at http://baderlab.org/Software/EnrichmentMap#Legends) that can be used for an enrichment map figure. You can manually select the components relevant to your analysis. Save Save all work as a Cytoscape session. In the Cytoscape menu, select File → Save As… Navigate to the directory in which you wish to save the session and specify the desired file name. "],
["references.html", "References", " References "]
]
